@*@model QuanLyHopDongVaKySo_API.Models.TemplateMinute

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
<link href="~/php/style.css" rel="stylesheet" />


<div class="container-fluid">
    <div class="page-header no-gutters has-tab">
        <div class="d-md-flex m-b-15 align-items-center justify-content-between">
            <div class="media align-items-center m-b-15">
                <br />
                <div class="m-l-15">
                    <h4 class="m-b-0"
                        style="width: 512px; height: 52px; color: #2B3674; font-size: 25px; font-family: DM Sans; font-weight: 700; line-height: 42px; word-wrap: break-word">
                        Chỉnh sửa cấu hình hợp đồng biên bản
                    </h4>
                </div>
            </div>

        </div>
    </div>
    <div style="margin: 10px;display: flex;align-items: end;justify-content: end;">
        <div class="SearchBox">
            <ul class="horizontal-list" style="list-style: none; display:flex; padding: 0.5rem;">
                <li>
                    <div class="Search">
                        <i class="ph-bold ph-magnifying-glass"></i>
                        <input type="text" placeholder="Search.." />
                    </div>
                </li>
                <li>
                    <a>
                        <i class="ph-bold ph-bell"></i>
                    </a>

                </li>
                <li>
                    <a>
                        <i class="ph-bold ph-moon"></i>
                    </a>
                </li>
                <li>
                    <img src="o.jpg" />
                </li>
            </ul>
        </div>
    </div>
    <br />
    <form class="row justify-content-around" style=" margin: 0 auto;" asp-action="TUpdateMinute" asp-controller="BusinessStaff" method="post">
        <div class="col-md-5">
            <div class="box1 row justify-content-between g-3 " style=" max-height: 800px;overflow-y: scroll; height:500px;">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                <div class="col-md-6">
                    <label asp-for="TMinuteID" class="form-label">Id</label>
                    <input class="form-control" disabled id="inputName" asp-for="TMinuteID">
                    <span class="text-danger" asp-validation-for="TMinuteID"></span>
                </div>

                <div class="col-md-6">
                    <label asp-for="jsonIntallationZone" class="form-label">Vị trí tải chữ ký </label>
                    <input class="form-control" id="inputName" asp-for="jsonIntallationZone">
                    <span class="text-danger" asp-validation-for="jsonIntallationZone"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="jsonCustomerZone" class="form-label">Vị trí chữ ký của nhân viên</label>
                    <input class="form-control" id="inputName" asp-for="jsonCustomerZone">
                    <span class="text-danger" asp-validation-for="jsonCustomerZone"></span>
                </div>
                <div class="col-md-7" style="margin:auto; padding: 20px 0;">
                    <button type="submit">
                        CẬP NHẬT
                    </button>
                </div>
            </div>
        </div>

    </form>
</div>*@

@model QuanLyHopDongVaKySo_API.Models.TemplateMinute

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
<link href="~/php/style.css" rel="stylesheet" />

<script src="https://unpkg.com/konva@9/konva.min.js"></script>


<div class="container-fluid">
    <div class="page-header no-gutters has-tab">
        <div class="d-md-flex m-b-15 align-items-center justify-content-between">
            <div class="media align-items-center m-b-15">
                <br />
                <div class="m-l-15">
                    <h4 class="m-b-0"
                        style="width: 512px; height: 52px; color: #2B3674; font-size: 34px; font-family: DM Sans; font-weight: 700; line-height: 42px; word-wrap: break-word">
                        Chỉnh sửa cấu hình hợp đồng biên bản
                    </h4>
                </div>
            </div>

        </div>
    </div>
    <div style="margin: 10px;display: flex;align-items: end;justify-content: end;">
        <div class="SearchBox">
            <ul class="horizontal-list" style="list-style: none; display:flex; padding: 0.5rem;">
                <li>
                    <div class="Search">
                        <i class="ph-bold ph-magnifying-glass"></i>
                        <input type="text" placeholder="Search.." />
                    </div>
                </li>
                <li>
                    <a>
                        <i class="ph-bold ph-bell"></i>
                    </a>

                </li>
                <li>
                    <a>
                        <i class="ph-bold ph-moon"></i>
                    </a>
                </li>
                <li>
                    <img src="o.jpg" />
                </li>
            </ul>
        </div>
    </div>
    <br />

    <div style="display: flex; justify-content: space-evenly; gap: 50px;">
        <button id="addDirectorSignature" type="button" class="button-22">Cập nhật vị trí chữ ký giám đốc</button>
        <!-- Thêm nút để thêm chữ ký một lần nữa -->
        <button id="addEmployeeSignature" type="button" class="button-22">Cập nhật vị trí chữ ký nhân viên</button>
    </div>
    <div id="paginationContainer" class="pagination">
        <button id="prevImage" class="round">Previous</button>
        <a id="currentImage" class="number">1</a>
        <button id="nextImage" class="round">Next</button>
    </div>
    <div id="stage-container" style="background-color: lightgrey; width: 800px; height: 600px;"></div>



    <script>
        var stage = new Konva.Stage({
            container: 'stage-container',
            width: 800,
            height: 600,
        });

        var layer = new Konva.Layer();
        stage.add(layer);

        var imagePaths = [
            '/ContractImage/1/1.png',
            '/ContractImage/1/2.png',
            '/ContractImage/1/3.png',
            '/ContractImage/1/4.png',
            '/ContractImage/1/5.png',
            '/ContractImage/1/6.png'
        ];

        var currentImageIndex = 0;

        var konvaImage = new Konva.Image({
            x: 0,
            y: 0,
            width: 800,
            height: 600,
        });

        layer.add(konvaImage);

        function showImage(index) {
            if (index >= 0 && index < imagePaths.length) {
                var imageObj = new Image();
                imageObj.src = imagePaths[index];

                imageObj.onload = function () {
                    konvaImage.image(imageObj);
                    layer.draw();
                    document.getElementById('currentImage').innerText = (index + 1);
                };
            }
        }

        document.getElementById('prevImage').addEventListener('click', function () {
            currentImageIndex = (currentImageIndex - 1 + imagePaths.length) % imagePaths.length;
            showImage(currentImageIndex);
        });

        document.getElementById('nextImage').addEventListener('click', function () {
            currentImageIndex = (currentImageIndex + 1) % imagePaths.length;
            showImage(currentImageIndex);
        });

        var directorSignatureAdded = false;
        var employeeSignatureAdded = false;

        // Thêm chữ ký khi nhấn nút "Thêm vị trí chữ ký giám đốc"
        document.getElementById('addDirectorSignature').addEventListener('click', function () {
            addSignature('director');
        });

        // Thêm chữ ký khi nhấn nút "Thêm vị trí chữ ký nhân viên"
        document.getElementById('addEmployeeSignature').addEventListener('click', function () {
            addSignature('employee');
        });

        function addSignature(role) {
            if (role === 'director' && !directorSignatureAdded) {
                // Create a new Konva.Group for the director's signature
                var signatureGroup = new Konva.Group({
                    x: 100,
                    y: 100,
                    draggable: true,
                });

                // Create a background rectangle for the director's signature
                var signatureRect = new Konva.Rect({
                    width: 140,
                    height: 70,
                    fill: 'transparent',
                    stroke: 'red',
                    strokeWidth: 2,
                });

                // Create a text object for the director's signature
                var signatureText = new Konva.Text({
                    width: 140,
                    height: 70,
                    text: 'Giám đốc',
                    fill: 'red',
                    fontSize: 24,
                    align: 'center',
                    verticalAlign: 'middle',
                });

                // Add the background rectangle and text to the group
                signatureGroup.add(signatureRect, signatureText);

                // Add the group to the layer
                layer.add(signatureGroup);
                layer.draw();

                // Update the flag to indicate that the director's signature has been added
                directorSignatureAdded = true;
                alert(`Chữ ký ${role} đã được thêm!`);
            } else if (role === 'employee' && !employeeSignatureAdded) {
                // Create a new Konva.Group for the employee's signature
                var signatureGroup = new Konva.Group({
                    x: 200,
                    y: 200,
                    draggable: true,
                });

                // Create a background rectangle for the employee's signature
                var signatureRect = new Konva.Rect({
                    width: 140,
                    height: 70,
                    fill: 'transparent',
                    stroke: 'black',
                    strokeWidth: 2,
                });

                // Create a text object for the employee's signature
                var signatureText = new Konva.Text({
                    width: 140,
                    height: 70,
                    text: 'Nhân viên',
                    fill: 'black',
                    fontSize: 24,
                    align: 'center',
                    verticalAlign: 'middle',
                });

                // Add the background rectangle and text to the group
                signatureGroup.add(signatureRect, signatureText);

                // Add the group to the layer
                layer.add(signatureGroup);
                layer.draw();

                // Update the flag to indicate that the employee's signature has been added
                employeeSignatureAdded = true;
                alert(`Chữ ký ${role} đã được thêm!`);
            } else {
                alert(`Chữ ký ${role} đã tồn tại!`);
            }
        }





        showImage(currentImageIndex);
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>



</div>





